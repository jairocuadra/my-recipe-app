<div class="related-policies">
  <div class="section-header">
    <h2 class="section-title">(4) Related Business Policies</h2>
    <div class="view-switcher" *ngIf="showViewSwitcher">
      <div class="toggle-button-group">
        <button class="toggle-button" [ngClass]="{'active': viewMode === 'table'}" (click)="toggleView('table')" matTooltip="Table View">
          <mat-icon>view_list</mat-icon>
          <span class="button-label">Table</span>
        </button>
        <button class="toggle-button" [ngClass]="{'active': viewMode === 'card'}" (click)="toggleView('card')" matTooltip="Card View">
          <mat-icon>view_module</mat-icon>
          <span class="button-label">Cards</span>
        </button>
      </div>
    </div>
  </div>
  
  <!-- Table View -->
  <mat-table [dataSource]="businessPolicies" class="policies-table" *ngIf="viewMode === 'table'">
    <!-- Policy Column -->
    <ng-container matColumnDef="policy">
      <mat-header-cell *matHeaderCellDef>Policy</mat-header-cell>
      <mat-cell *matCellDef="let element">{{element.policy}}</mat-cell>
    </ng-container>

    <!-- Status Column -->
    <ng-container matColumnDef="status">
      <mat-header-cell *matHeaderCellDef>Status</mat-header-cell>
      <mat-cell *matCellDef="let element">
        <span class="status-badge" [ngClass]="element.status.toLowerCase()">
          {{element.status}}
        </span>
      </mat-cell>
    </ng-container>

    <!-- Insured Column -->
    <ng-container matColumnDef="insured">
      <mat-header-cell *matHeaderCellDef>Insured</mat-header-cell>
      <mat-cell *matCellDef="let element">{{element.insured}}</mat-cell>
    </ng-container>

    <!-- Issued Date Column -->
    <ng-container matColumnDef="issuedDate">
      <mat-header-cell *matHeaderCellDef>Issued Date</mat-header-cell>
      <mat-cell *matCellDef="let element">{{element.issuedDate}}</mat-cell>
    </ng-container>

    <!-- Business Name Column -->
    <ng-container matColumnDef="businessName">
      <mat-header-cell *matHeaderCellDef>Business Name</mat-header-cell>
      <mat-cell *matCellDef="let element">{{element.businessName}}</mat-cell>
    </ng-container>

    <!-- Tax ID Column -->
    <ng-container matColumnDef="taxId">
      <mat-header-cell *matHeaderCellDef>Tax ID</mat-header-cell>
      <mat-cell *matCellDef="let element">{{element.taxId}}</mat-cell>
    </ng-container>

    <!-- Category Column -->
    <ng-container matColumnDef="category">
      <mat-header-cell *matHeaderCellDef>Category</mat-header-cell>
      <mat-cell *matCellDef="let element">{{element.category}}</mat-cell>
    </ng-container>

    <!-- Previous POI Flag Column -->
    <ng-container matColumnDef="previousPOIFlag">
      <mat-header-cell *matHeaderCellDef>Previous POI Flag</mat-header-cell>
      <mat-cell *matCellDef="let element">{{element.previousPOIFlag}}</mat-cell>
    </ng-container>

    <!-- Audit POI Column -->
    <ng-container matColumnDef="auditPOI">
      <mat-header-cell *matHeaderCellDef>Audit POI</mat-header-cell>
      <mat-cell *matCellDef="let element">{{element.auditPOI}}</mat-cell>
    </ng-container>

    <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
    <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
  </mat-table>
  
  <!-- Card View -->
  <div class="policies-cards" *ngIf="viewMode === 'card'">
    <div class="policy-card" *ngFor="let policy of businessPolicies">
      <div class="card-header">
        <div class="policy-number">{{policy.policy}}</div>
        <span class="status-badge" [ngClass]="policy.status.toLowerCase()">
          {{policy.status}}
        </span>
      </div>
      <div class="card-content">
        <div class="info-row">
          <div class="info-label">Insured:</div>
          <div class="info-value">{{policy.insured}}</div>
        </div>
        <div class="info-row">
          <div class="info-label">Business:</div>
          <div class="info-value">{{policy.businessName}}</div>
        </div>
        <div class="info-row">
          <div class="info-label">Issued Date:</div>
          <div class="info-value">{{policy.issuedDate}}</div>
        </div>
        <div class="info-row">
          <div class="info-label">Tax ID:</div>
          <div class="info-value">{{policy.taxId}}</div>
        </div>
        <div class="info-row">
          <div class="info-label">Category:</div>
          <div class="info-value">{{policy.category}}</div>
        </div>
        <div class="info-row">
          <div class="info-label">Previous POI Flag:</div>
          <div class="info-value">{{policy.previousPOIFlag}}</div>
        </div>
        <div class="info-row">
          <div class="info-label">Audit POI:</div>
          <div class="info-value">{{policy.auditPOI}}</div>
        </div>
      </div>
    </div>
  </div>
</div>
